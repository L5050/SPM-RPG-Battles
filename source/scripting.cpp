#include "evt_cmd.h"
#include "mod.h"
#include "patch.h"
#include "main_scripting.h"
#include "npc_rpgdrv.h"

#include <spm/rel/an.h>
#include <spm/evtmgr.h>
#include <spm/evt_ac.h>
#include <spm/evt_msg.h>
#include <spm/evt_mario.h>
#include <spm/evt_pouch.h>
#include <spm/evt_fade.h>
#include <spm/evt_map.h>
#include <spm/evt_paper.h>
#include <spm/evt_img.h>
#include <spm/evt_env.h>
#include <spm/evt_eff.h>
#include <spm/evt_fairy.h>
#include <spm/evt_snd.h>
#include <spm/evt_cam.h>
#include <spm/evt_sub.h>
#include <spm/evt_npc.h>
#include <spm/evt_mobj.h>
#include <spm/evt_door.h>
#include <spm/evt_case.h>
#include <spm/evt_pouch.h>
#include <spm/evt_seq.h>
#include <spm/rel/an2_08.h>
#include <spm/rel/sp4_13.h>
#include <spm/rel/an.h>
#include <spm/wpadmgr.h>
#include <spm/fontmgr.h>
#include <spm/seqdrv.h>
#include <spm/seq_game.h>
#include <spm/npcdrv.h>
#include <spm/mario.h>
#include <spm/mario_pouch.h>
#include <spm/mario_motion.h>
#include <spm/seqdef.h>
#include <spm/item_data.h>
#include <spm/item_event_data.h>
#include <wii/os/OSError.h>
#include <patch.h>
#include <string>
namespace mod {

const char * tippi_fail = "<p>\n"
"This enemy cannot be\n"
"pacified!\n"
"<k>\n"
"<o>\n";

const char * tippi_pacify = "<p>\n"
"Tippi sings a\n"
"magical song!\n"
"<o>\n";

const char * tippi_pacify_success = "<p>\n"
"%d enemies were\n"
"pacified!\n"
"<k>\n"
"<o>\n";

const char * tutorial = "<dq>\n"
"<p>\n"
"You ever been in a battle before?\n"
"<k>\n"
"<p>\n"
"No worries.\n"
"I'll give you the tour!\n"
"<k>\n"
"<p>\n"
"Press <icon PAD_2 0.67 0 0 2><col cffffff> right before landing\n"
"on an enemy to jump on them\n"
"an extra time!\n"
"<k>\n"
"<p>\n"
"Press <icon PAD_A 0.67 0 0 2><col cffffff> right after finishing\n"
"an attack to perform a\n"
"stylish move!\n"
"<k>\n"
"<p>\n"
"Stylish moves can be chained\n"
"together by pressing <icon PAD_A 0.67 0 0 2><col cffffff> right\n"
"after landing from one.\n"
"<k>\n"
"<p>\n"
"Press B before an enemy\n"
"attacks to guard from the\n"
"incoming damage!\n"
"<k>\n"
"<p>\n"
"If you have good enough timing,\n"
"you might even SUPERGUARD and\n"
"take no damage at all!\n"
"<k>\n"
"<p>\n"
"Special techniques and\n"
"Pixls use up 1 FP.\n"
"Use it wisely...\n"
"<k>\n"
"<p>\n"
"<scale 0.5>developers note, attacks other than jumping and\n"
"cudge do not look visually the best and dont support stylish\n"
"moves yet\n"
"<k>\n"
"<p>\n"
"<scale 1.0>Enjoy!\n"
"-Lily\n"
"<k>\n"
"<o>\n";

s32 mario_chg_paper(spm::evtmgr::EvtEntry * evtEntry, bool firstRun)
{
    spm::evtmgr::EvtVar * args = (spm::evtmgr::EvtVar *)evtEntry->pCurData;
    spm::mario::marioPaperOn((const char *) args[0]);
    return 2;
}

s32 mario_chg_motion(spm::evtmgr::EvtEntry * evtEntry, bool firstRun)
{
    spm::evtmgr::EvtVar * args = (spm::evtmgr::EvtVar *)evtEntry->pCurData;
    spm::mario::marioGetPtr()->ttydRotation = {0.0, 0.0, 0.0};
    return 2;
}

s32 mario_set_scale(spm::evtmgr::EvtEntry * evtEntry, bool firstRun)
{
    spm::evtmgr::EvtVar * args = (spm::evtmgr::EvtVar *)evtEntry->pCurData;
    f32 x = spm::evtmgr_cmd::evtGetFloat(evtEntry, args[0]);
    f32 y = spm::evtmgr_cmd::evtGetFloat(evtEntry, args[1]);
    f32 z = spm::evtmgr_cmd::evtGetFloat(evtEntry, args[2]);
    spm::mario::marioGetPtr()->scale = {x, y, z};
    return 2;
}

s32 mario_rotate(spm::evtmgr::EvtEntry * evtEntry, bool firstRun)
{
    spm::evtmgr::EvtVar * args = (spm::evtmgr::EvtVar *)evtEntry->pCurData;
    f32 rotation = spm::evtmgr_cmd::evtGetFloat(evtEntry, args[0]);
    spm::mario::marioGetPtr()->dispDirectionCurrent = rotation;
    return 2;
}

/*s32 rpg_check_for_bounding_box(spm::evtmgr::EvtEntry * evtEntry, bool firstRun)
{
    spm::evtmgr::EvtVar * args = (spm::evtmgr::EvtVar *)evtEntry->pCurData;
    const char * name = (const char *)spm::evtmgr_cmd::evtGetValue(evtEntry, args[0]);
    spm::npcdrv::NPCEntry * entry = spm::npcdrv::npcNameToPtr(name);
    Vec3 pos = entry->position;
    static s32 i;
    if (firstRun)
    {
      i = 0;
    }
    spm::mapdrv::MapWorkGroup * mapWork = spm::mapdrv::mapGetWork();
    for (i < mapWork->entries[0].mapObjCount; i++;)
    {
      Vec3 min = mapWork->entries[0].mapObjs[i].joint->bboxMin;
      Vec3 max = mapWork->entries[0].mapObjs[i].joint->bboxMax;
      if (pos.x > min.x && pos.x < max.x && pos.y > min.y && pos.y < max.y) {
        spm::evtmgr_cmd::evtSetValue(evtEntry, args[1], 1);
      }
      if (i < mapWork->entries[0].mapObjCount) return 0;
    }
    
    i = 0;
    spm::evtmgr_cmd::evtSetValue(evtEntry, args[1], 0);
    return 2;
}*/

EVT_BEGIN(rpg_snd_miss_evt)
    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_EVT_HELWANWAN_MISS1"))
    DO(3)
        USER_FUNC(spm::an2_08::evt_rpg_status_remove, 1, LW(10), 32)
        WAIT_FRM(3)
        USER_FUNC(spm::an2_08::evt_rpg_status_remove, 0, LW(10), 32)
        WAIT_FRM(3)
    WHILE()
    RETURN()
EVT_END()

EVT_BEGIN(rpg_snd_hit_evt)
    DO(4)
        USER_FUNC(spm::an2_08::evt_rpg_status_remove, 1, LW(10), 16)
        WAIT_FRM(4)
        USER_FUNC(spm::an2_08::evt_rpg_status_remove, 0, LW(10), 16)
        WAIT_FRM(4)
    WHILE()
    RETURN()
EVT_END()

EVT_BEGIN(marioRPGtakeDamage) //80def490
    ADDF(LW(1), FLOAT(25.0))
    USER_FUNC(displayDamage, LW(0), LW(1), LW(2), LW(10))
    IF_EQUAL(LW(11), 0)
      USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("D_2"), 0)
    END_IF()
    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_MARIO_DAMAGE1"))
    USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_V_MARIO_DAMEGE1"), PTR("SFX_P_V_PEACH_DAMEGE1"), PTR("SFX_P_V_KOOPA_DAMEGE1"), PTR("SFX_P_V_LUIGI_DAMEGE1"))
    USER_FUNC(spm::evt_cam::evt_cam_shake, 11, FLOAT(1.5), FLOAT(1.5), FLOAT(0.0), 200, 0)
    RETURN()
EVT_END()

EVT_BEGIN(calcDamageTaken)
    IF_EQUAL(GSW(0), 170)
    SWITCH(LW(7))
      CASE_EQUAL(7)
        SET(LW(10), 90)
        SET(LW(7), 0)
      CASE_EQUAL(6)
        SET(LW(7), 1)
      CASE_EQUAL(5)
        SET(LW(7), 2)
      CASE_EQUAL(4)
        SET(LW(7), 3)
      CASE_EQUAL(2)
        SET(LW(10), 1000)
        SET(LW(7), 5)
    END_SWITCH()
    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
    IF_FLAG(LW(0), 0x600)
        SET(LW(10), 1000)
    END_IF()
    USER_FUNC(spm::evt_mario::evt_mario_get_character, LW(0))
    SWITCH(LW(0))
        CASE_EQUAL(1)
            ADD(LW(10), -50)
        CASE_EQUAL(2)
            IF_EQUAL(LW(7), 0)
            ADD(LW(10), 1)
        ELSE()
            ADD(LW(10), 100)
        END_IF()
    END_SWITCH()
    END_IF()
RETURN()
EVT_END()

EVT_BEGIN(marioRPGdodge)
    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_EVT_HELWANWAN_MISS1"))
    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_EVT_HELWANWAN_MISS1"))
    RETURN()
EVT_END()

EVT_BEGIN(checkMarioDeath)
    USER_FUNC(spm::evt_pouch::evt_pouch_get_hp, LW(0))
    IF_LARGE_EQUAL(LW(0), 1)
        RETURN()
    END_IF()
    USER_FUNC(spm::evt_pouch::evt_pouch_check_have_item, 84, LW(0))
    IF_EQUAL(LW(0), 0)
        USER_FUNC(spm::evt_mario::evt_mario_get_character, LW(0))
        SWITCH(LW(0))
            CASE_EQUAL(0)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_107"))
            CASE_EQUAL(2)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_108"))
            CASE_EQUAL(3)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_109"))
        END_SWITCH()
        USER_FUNC(mod::rpg_off)
        USER_FUNC(spm::evt_fade::evt_fade_entry, 65538, 1000, 0, 0, 0, 255)
        USER_FUNC(spm::evt_fade::evt_fade_end_wait, -1)
        USER_FUNC(spm::evt_seq::evt_seq_set_seq, 4, 0, 0)
    ELSE()
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(0))
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_110"), LW(0))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KINKYU_KINOKO1"))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_EFFECT_SMALL1"))
        WAIT_MSEC(350)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_SMALL1"))
        USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_111"))
        USER_FUNC(spm::evt_pouch::evt_pouch_add_hp, 5)
        USER_FUNC(spm::evt_pouch::evt_pouch_remove_item, 84)
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 32768)
    END_IF()
    RETURN()
EVT_END()

EVT_BEGIN(brobotAttack)
    USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 1, LW(0))
    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 1, LW(1))
    IF_FLAG(LW(0), 0x8000)
        RETURN()
    END_IF()
    IF_FLAG(LW(0), 0x3)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_112"), LW(1))
        RETURN()
    END_IF()
    IF_FLAG(LW(0), 0x4)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_114"), LW(1))
        RETURN()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(2))
    USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(3))
    IF_FLAG(LW(2), 0x5)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_113"), LW(1), LW(3))
        RETURN()
    END_IF()
    USER_FUNC(spm::evt_sub::evt_sub_random, 4000, LW(10))
    SWITCH(LW(10))
        CASE_SMALL(1000)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_093"), LW(1))
            INLINE_EVT()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_BOMB_FIRE1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_BOMB_FIRE1"))
            END_INLINE()
            USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
            USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 4)
            USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
            USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
            RUN_CHILD_EVT(mod::calcDamageTaken)
            IF_SMALL(LW(10), 100)
                RUN_CHILD_EVT(mod::marioRPGdodge)
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_096"), LW(3))
            ELSE()
                USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
                IF_FLAG(LW(0), 0x10)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_095"))
                ELSE()
                    RUN_CHILD_EVT(mod::marioRPGtakeDamage)
                    USER_FUNC(spm::an2_08::evt_rpg_calc_mario_damage, 0, LW(10))
                    ADD(LW(10), LW(7))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_094"), LW(3), LW(10))
                    USER_FUNC(spm::an2_08::evt_rpg_mario_take_damage, LW(10), 0, LW(0))
                END_IF()
            END_IF()
        CASE_SMALL(2000)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_097"))
            INLINE_EVT()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_EVT_HELWANWAN_FIRE1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_EVT_HELWANWAN_FIRE1"))
            END_INLINE()
            USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
            USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 4)
            USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
            USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
            RUN_CHILD_EVT(mod::calcDamageTaken)
            IF_SMALL(LW(10), 300)
                RUN_CHILD_EVT(mod::marioRPGdodge)
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_099"), LW(3))
            ELSE()
                USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
                IF_FLAG(LW(0), 0x10)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_095"))
                ELSE()
                    RUN_CHILD_EVT(mod::marioRPGtakeDamage)
                    USER_FUNC(spm::an2_08::evt_rpg_calc_mario_damage, 0, LW(10))
                    ADD(LW(10), 2)
                    ADD(LW(10), LW(7))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_098"), LW(3), LW(10))
                    USER_FUNC(spm::an2_08::evt_rpg_mario_take_damage, LW(10), 0, LW(0))
                END_IF()
            END_IF()
            CASE_SMALL(3000)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("brobot_toxic_serum"))
                INLINE_EVT()
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KIRAKIRA1"))
                USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_KIRAKIRA1"))
                END_INLINE()
                USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
                USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 4)
                USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
                USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
                RUN_CHILD_EVT(mod::calcDamageTaken)
                IF_SMALL(LW(10), 300)
                    RUN_CHILD_EVT(mod::marioRPGdodge)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_099"), LW(3))
                ELSE()
                    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
                    IF_FLAG(LW(0), 0x10)
                        USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_095"))
                    ELSE()
                        RUN_CHILD_EVT(mod::marioRPGtakeDamage)
                        USER_FUNC(spm::an2_08::evt_rpg_calc_mario_damage, 0, LW(10))
                        ADD(LW(10), 1)
                        ADD(LW(10), LW(7))
                        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_098"), LW(3), LW(10))
                        USER_FUNC(spm::an2_08::evt_rpg_mario_take_damage, LW(10), 0, LW(0))
                    END_IF()
                END_IF()
        CASE_ETC()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_EVT_HELWANWAN_POWERUP1"))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_106"), LW(1))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_EVT_HELWANWAN_POWERUP1"))
            USER_FUNC(mod::increaseAttack, 1)
    END_SWITCH()
    RUN_CHILD_EVT(mod::checkMarioDeath)
    RETURN()
EVT_END()

EVT_BEGIN(rpgDeathHandler)
  USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
  IF_NOT_FLAG(LW(0), 0x8000)
      RETURN()
  END_IF()
  USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
  USER_FUNC(spm::evt_pouch::evt_pouch_check_have_item, 84, LW(0)) //checks if mario has a life shroom
  IF_EQUAL(LW(0), 0) //if not, rpg death screen plays
      USER_FUNC(spm::evt_mario::evt_mario_get_character, LW(0))
      SWITCH(LW(0))
          CASE_EQUAL(0)
              USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_107"))
          CASE_EQUAL(2)
              USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_108"))
          CASE_EQUAL(3)
              USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_109"))
      END_SWITCH()
      USER_FUNC(spm::evt_fade::evt_fade_entry, 65538, 1000, 0, 0, 0, 255)
      USER_FUNC(spm::evt_fade::evt_fade_end_wait, -1)
      USER_FUNC(mod::rpg_off)
      USER_FUNC(rpg_set_dialogue, PTR(stg7_2_133_2_002))
      USER_FUNC(spm::evt_seq::evt_seq_set_seq, 4, 0, 0)
  ELSE() //if yes, life shroom revives the party
      USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(0))
      USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_110"), LW(0))
      USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KINKYU_KINOKO1"))
      USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_EFFECT_SMALL1"))
      WAIT_MSEC(350)
      USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_SMALL1"))
      USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_111"))
      USER_FUNC(spm::evt_pouch::evt_pouch_add_hp, 5)
      USER_FUNC(spm::evt_pouch::evt_pouch_remove_item, 84)
      USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 32768)
  END_IF()
  RETURN()
EVT_END()

EVT_BEGIN(runEnemyDeath)
IF_FLAG(LW(0), 0x8000)
  USER_FUNC(get_rpg_enemy_death_script, UW(0), LW(3))
  IF_NOT_EQUAL(LW(3), 0)
    RUN_CHILD_EVT(LW(3))
    RETURN()
  END_IF()
  SWITCH(UW(0))
      CASE_EQUAL(0)
        USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc1"), 4, 1)
        BROTHER_EVT_ID(LW(10))
          SET(LW(9), FLOAT(0.0))
          DO(0)
          ADDF(LW(9), FLOAT(9.0))
          USER_FUNC(spm::evt_npc::evt_npc_rotate, PTR("npc1"), EVT_NULLPTR, LW(9), EVT_NULLPTR)
          WAIT_FRM(1)
          WHILE()
        END_BROTHER()
        WAIT_MSEC(1000)
        DELETE_EVT(LW(10))
        USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc1"), LW(5), LW(6), LW(7))
        USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("kemuri_test"), 0, LW(5), LW(6), LW(7), FLOAT(2.0), 0, 0, 0, 0, 0, 0, 0)
        USER_FUNC(spm::evt_npc::evt_npc_delete, PTR("npc1"))
        USER_FUNC(spm::evt_mobj::evt_mobj_delete, PTR("mobj1"))
      CASE_EQUAL(1)
        BROTHER_EVT_ID(LW(10))
          SET(LW(9), FLOAT(0.0))
          DO(0)
          ADDF(LW(9), FLOAT(9.0))
          USER_FUNC(spm::evt_npc::evt_npc_rotate, PTR("npc2"), EVT_NULLPTR, LW(9), EVT_NULLPTR)
          WAIT_FRM(1)
          WHILE()
        END_BROTHER()
        WAIT_MSEC(1000)
        DELETE_EVT(LW(10))
        USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc2"), LW(5), LW(6), LW(7))
        USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("kemuri_test"), 0, LW(5), LW(6), LW(7), FLOAT(2.0), 0, 0, 0, 0, 0, 0, 0)
        USER_FUNC(spm::evt_npc::evt_npc_delete, PTR("npc2"))
        USER_FUNC(spm::evt_mobj::evt_mobj_delete, PTR("mobj2"))
      CASE_EQUAL(2)
        BROTHER_EVT_ID(LW(10))
          SET(LW(9), FLOAT(0.0))
          DO(0)
          ADDF(LW(9), FLOAT(9.0))
          USER_FUNC(spm::evt_npc::evt_npc_rotate, PTR("npc3"), EVT_NULLPTR, LW(9), EVT_NULLPTR)
          WAIT_FRM(1)
          WHILE()
        END_BROTHER()
        WAIT_MSEC(1000)
        DELETE_EVT(LW(10))
        USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc3"), LW(5), LW(6), LW(7))
        USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("kemuri_test"), 0, LW(5), LW(6), LW(7), FLOAT(2.0), 0, 0, 0, 0, 0, 0, 0)
        USER_FUNC(spm::evt_npc::evt_npc_delete, PTR("npc3"))
        USER_FUNC(spm::evt_mobj::evt_mobj_delete, PTR("mobj3"))
  END_SWITCH()
  USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_ENEMY_DIE1"))
  USER_FUNC(get_rpg_name_by_id, UW(0), LW(1))
  USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
  USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_007"), LW(1)) //You defeated [enemy]!
  USER_FUNC(spm::evt_msg::evt_msg_continue)
  ELSE()
  IF_FLAG(LW(0), 0x1)
      USER_FUNC(spm::an2_08::evt_rpg_status_remove, 0, UW(0), 1)
      USER_FUNC(get_rpg_name_by_id, UW(0), LW(1))
      USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
      USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_115"), LW(1))
      USER_FUNC(spm::evt_msg::evt_msg_continue)
  END_IF()
END_IF()
EVT_END()

EVT_BEGIN(runEnemyTurn)
  USER_FUNC(ac_success_reset)
  USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("S_1"), 0)
  USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 0, LW(0))
  IF_NOT_FLAG(LW(0), 0x8000)
      USER_FUNC(get_rpg_enemy_attack_script, 0, LW(0))
      IF_NOT_EQUAL(LW(0), 0)
        SET(UW(0), 0)
        SET(LW(15), PTR("npc1"))
        RUN_CHILD_EVT(LW(0))
      END_IF()
  END_IF()
  USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("S_1"), 0)
  USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 1, LW(0))
  IF_NOT_FLAG(LW(0), 0x8000)
      USER_FUNC(get_rpg_enemy_attack_script, 1, LW(0))
      IF_NOT_EQUAL(LW(0), 0)
        SET(UW(0), 1)
        SET(LW(15), PTR("npc2"))
        RUN_CHILD_EVT(LW(0))
      END_IF()
  END_IF()
  USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("S_1"), 0)
  USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 2, LW(0))
  IF_NOT_FLAG(LW(0), 0x8000)
      USER_FUNC(get_rpg_enemy_attack_script, 2, LW(0))
      IF_NOT_EQUAL(LW(0), 0)
        SET(UW(0), 2)
        SET(LW(15), PTR("npc3"))
        RUN_CHILD_EVT(LW(0))
      END_IF()
  END_IF()
  USER_FUNC(ac_success_reset)
  RUN_CHILD_EVT(rpgDeathHandler)
  RETURN()
EVT_END()

EVT_BEGIN(damageAnims)
  SWITCH(LW(2))
      CASE_EQUAL(0)
        USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc1"), 4, 1)
        WAIT_MSEC(300)
        USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(2), 0, 0, LW(0))
        IF_NOT_FLAG(LW(0), 0x8000)
          USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc1"), 0, 1)
        END_IF()
      CASE_EQUAL(1)
        USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc2"), 4, 1)
        WAIT_MSEC(300)
        USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(2), 0, 0, LW(0))
        IF_NOT_FLAG(LW(0), 0x8000)
          USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc2"), 0, 1)
        END_IF()
      CASE_EQUAL(2)
        USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc3"), 4, 1)
        WAIT_MSEC(300)
        USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(2), 0, 0, LW(0))
        IF_NOT_FLAG(LW(0), 0x8000)
          USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc3"), 0, 1)
        END_IF()
  END_SWITCH()
  RETURN()
EVT_END()

EVT_BEGIN(end_of_turn_stylish)
    USER_FUNC(ac_success_reset)
    INLINE_EVT()
      SET(LW(10), 0)
      LBL(1)
          USER_FUNC(check_pressed_a_ac, LW(11))
          USER_FUNC(enable_disable_stylish, 1)
          IF_EQUAL(LW(11), 1)
            USER_FUNC(ac_success_toggle)
            GOTO(2)
          END_IF()
        WAIT_FRM(1)
        ADD(LW(10), 1)
        IF_EQUAL(LW(10), 10)
          GOTO(2)
        END_IF()
      GOTO(1)
      LBL(2)
      USER_FUNC(enable_disable_stylish, 0)
    END_INLINE()
    WAIT_FRM(10)
    INLINE_EVT()
      USER_FUNC(spm::evt_cam::evt_cam3d_evt_zoom_in, 0, UW(1), EVT_NULLPTR, UW(3), UW(1), EVT_NULLPTR, 200, 180, 11)
    END_INLINE()
    USER_FUNC(check_ac_success, LW(11))
    IF_EQUAL(LW(11), 1)
        USER_FUNC(spm::evt_sub::evt_sub_random, 100, LW(5))
        ADD(LW(5), 50)
        USER_FUNC(spm::an2_08::evt_rpg_add_xp, LW(5))
        USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_ACROBAT_RENZOKU1"))
        USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("nice"), UW(6), 150, 0, 0, FLOAT(1.0), 0, 0, 0, 0, 0, 0, 0) 
        RUN_CHILD_EVT(increase_stylish)
        SET(LW(5), UW(4))
        INLINE_EVT()
            SET(LW(11), 0)
            SETF(LW(10), FLOAT(0.0))
            DO(0)
              USER_FUNC(mario_rotate, LW(10))
              ADD(LW(11), 1)
              ADDF(LW(10), FLOAT(25.0))
              WAIT_FRM(1)
              IF_EQUAL(LW(11), 20)
                DO_BREAK()
              END_IF()
            WHILE()
        END_INLINE()
        USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("AC_1"), 500)
        USER_FUNC(ac_success_reset)
        INLINE_EVT()
            SET(LW(10), 0)
            LBL(1)
            IF_LARGE(LW(10), 10)
                USER_FUNC(check_pressed_a_ac, LW(11))
                USER_FUNC(enable_disable_stylish, 1)
                IF_EQUAL(LW(11), 1)
                    USER_FUNC(ac_success_toggle)
                    GOTO(2)
                END_IF()
            END_IF()
            WAIT_FRM(1)
            ADD(LW(10), 1)
            IF_EQUAL(LW(10), 20)
            GOTO(2)
            END_IF()
            GOTO(1)
            LBL(2)
            USER_FUNC(enable_disable_stylish, 0)
        END_INLINE()
        USER_FUNC(spm::evt_mario::evt_mario_jump_to, LW(5), 0, 0, 60, 500)
        USER_FUNC(check_ac_success, LW(11))
        IF_EQUAL(LW(11), 1)
            USER_FUNC(spm::evt_sub::evt_sub_random, 100, LW(5))
            ADD(LW(5), 50)
            USER_FUNC(spm::an2_08::evt_rpg_add_xp, LW(5))
            USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_ACROBAT_RENZOKU1"))
            USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("nice"), UW(6), -250, 0, 0, FLOAT(1.0), 0, 0, 0, 0, 0, 0, 0)
            RUN_CHILD_EVT(increase_stylish)
            SET(LW(5), UW(4))
            INLINE_EVT()
                SET(LW(11), 0)
                SETF(LW(10), FLOAT(0.0))
                DO(0)
                USER_FUNC(mario_rotate, LW(10))
                ADD(LW(11), 1)
                ADDF(LW(10), FLOAT(25.0))
                WAIT_FRM(1)
                IF_EQUAL(LW(11), 20)
                    DO_BREAK()
                END_IF()
                WHILE()
            END_INLINE()
            USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("AC_1"), 500)
            USER_FUNC(spm::evt_mario::evt_mario_jump_to, LW(5), LW(6), LW(7), 60, 500)
            WAIT_FRM(2)
            USER_FUNC(spm::evt_mario::evt_mario_get_character, LW(5))
            SWITCH(LW(5))
              CASE_EQUAL(2)
                USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("AC_5"), 0)
              CASE_EQUAL(3)
                USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("AC_6"), 0)
              CASE_ETC()
                USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("AC_7"), 0)
            END_SWITCH()
        END_IF()
    ELSE()
      SET(LW(5), UW(4))
      USER_FUNC(spm::evt_mario::evt_mario_pos_change, LW(5), LW(7), FLOAT(180.0))
      USER_FUNC(spm::evt_mario::evt_mario_set_pos, LW(5), FLOAT(0.0), FLOAT(0.0))
    END_IF()
    USER_FUNC(spm::evt_mario::evt_mario_direction_face, 90, 200)
    WAIT_FRM(40)
    RETURN()
EVT_END()

EVT_BEGIN(rpg_jump)
  USER_FUNC(spm::evt_mobj::evt_mobj_hit_onoff, 1, LW(15))
  INLINE_EVT()
  SET(LW(10), 0)
  LBL(1)
    IF_SMALL(LW(10), 20)
      USER_FUNC(check_pressed_2_ac, LW(11))
      IF_EQUAL(LW(11), 1)
        GOTO(2)
      END_IF()
    ELSE()
      USER_FUNC(check_pressed_2_ac, LW(11))
      IF_EQUAL(LW(11), 1)
        USER_FUNC(ac_success_toggle)
        GOTO(2)
      END_IF()
    END_IF()
    WAIT_FRM(1)
    ADD(LW(10), 1)
    IF_EQUAL(LW(10), 30)
      GOTO(2)
    END_IF()
  GOTO(1)
  LBL(2)
  END_INLINE()
  USER_FUNC(spm::evt_mario::evt_mario_jump_to, LW(5), LW(6), LW(7), 60, 500)
  USER_FUNC(check_ac_success, LW(11))
  USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(2), 0, LW(10))
  IF_EQUAL(LW(11), 1)
  USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_V_MARIO_ATTACK1"), PTR("SFX_P_V_PEACH_ATTACK1"), PTR("SFX_P_V_KOOPA_ATTACK1"), PTR("SFX_P_V_LUIGI_ATTACK1"))
  USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
  USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(2), LW(10), 0, LW(0))
  USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
  RUN_EVT(damageAnims)
  USER_FUNC(spm::evt_mario::evt_mario_jump_to, LW(5), LW(6), LW(7), 80, 700)
  USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
  USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_V_MARIO_ATTACK1"), PTR("SFX_P_V_PEACH_ATTACK1"), PTR("SFX_P_V_KOOPA_ATTACK1"), PTR("SFX_P_V_LUIGI_ATTACK1"))
  USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
  USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(2), LW(10), 0, LW(0))
  RUN_EVT(damageAnims)
  ELSE()
    USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
    USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_V_MARIO_ATTACK1"), PTR("SFX_P_V_PEACH_ATTACK1"), PTR("SFX_P_V_KOOPA_ATTACK1"), PTR("SFX_P_V_LUIGI_ATTACK1"))
    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(2), LW(10), 0, LW(0))
    RUN_EVT(damageAnims)
  END_IF()
  USER_FUNC(spm::evt_mobj::evt_mobj_hit_onoff, 0, LW(15))
  RETURN()
EVT_END()

EVT_BEGIN(attack)
    SET(UW(0), LW(2))
    USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_004"), LW(10))
    USER_FUNC(enable_disable_rpg_menu, 0)
    USER_FUNC(spm::evt_msg::evt_msg_continue)
    USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
    SET(LW(5), UW(4))
    ADD(LW(5), 150)
    INLINE_EVT()
      SET(LW(10), UW(3))
      SUB(LW(10), 25)
      USER_FUNC(spm::evt_cam::evt_cam3d_evt_zoom_in, 0, LW(5), EVT_NULLPTR, LW(10), LW(5), EVT_NULLPTR, 200, 1000, 11)
    END_INLINE()
    USER_FUNC(spm::evt_mario::evt_mario_pos_change, LW(5), LW(7), FLOAT(180.0))
    SWITCH(LW(2))
        CASE_EQUAL(0)
          USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc1"), LW(5), LW(6), LW(7))
        CASE_EQUAL(1)
          USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc2"), LW(5), LW(6), LW(7))
        CASE_EQUAL(2)
          USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc3"), LW(5), LW(6), LW(7))
    END_SWITCH()
    USER_FUNC(get_rpg_enemy_damage_script, LW(2), LW(14))
    IF_NOT_EQUAL(LW(14), 0)
      SET(UW(0), LW(2))
      SWITCH(LW(2))
        CASE_EQUAL(0)
          SET(LW(15), PTR("npc1"))
        CASE_EQUAL(1)
          SET(LW(15), PTR("npc2"))
        CASE_EQUAL(2)
          SET(LW(15), PTR("npc3"))
      END_SWITCH()
      RUN_CHILD_EVT(LW(14))
    ELSE()
      SET(UW(0), LW(2))
      SWITCH(LW(2))
        CASE_EQUAL(0)
          SET(LW(15), PTR("mobj1"))
        CASE_EQUAL(1)
          SET(LW(15), PTR("mobj2"))
        CASE_EQUAL(2)
          SET(LW(15), PTR("mobj3"))
      END_SWITCH()
      RUN_CHILD_EVT(rpg_jump)
    END_IF()
    RUN_EVT(end_of_turn_stylish)
    SUB(LW(5), 10)
    USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
    USER_FUNC(spm::evt_mario::evt_mario_jump_to, LW(5), LW(6), LW(7), 10, 200)
    WAIT_FRM(60)
    RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
    RUN_CHILD_EVT(runEnemyDeath)
    USER_FUNC(ac_success_reset)
    USER_FUNC(enable_disable_rpg_menu, 0)
    RETURN()
EVT_END()

EVT_BEGIN(technique)
SET(UW(0), LW(4))
USER_FUNC(spm::evt_mario::evt_mario_get_character, LW(10))
SWITCH(LW(10))
    CASE_EQUAL(0) //Mario
        USER_FUNC(enable_disable_rpg_menu, 0)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_SEARCH_DESIDE1_TV"))
        USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
        INLINE_EVT()
          SET(LW(13), UW(3))
          SUB(LW(13), 25)
          USER_FUNC(spm::evt_cam::evt_cam3d_evt_zoom_in, 0, LW(5), EVT_NULLPTR, LW(13), LW(5), EVT_NULLPTR, 200, 1000, 11)
        END_INLINE()
        USER_FUNC(msgSearchTribeToTattle, UW(0), LW(0))
        SET(LW(1), PTR("__guide__"))
        USER_FUNC(spm::an2_08::evt_rpg_calc_mario_damage, UW(0), LW(10))
        USER_FUNC(get_rpg_enemy_max_hp, UW(0), LW(9))
        USER_FUNC(spm::evt_msg::evt_msg_print_insert, 0, LW(0), 0, LW(1), LW(9), LW(10))
    CASE_EQUAL(1) //Peach
        USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("peach_heal"))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_ITEM_USE1"))
        USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 3)
        USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
        USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
        USER_FUNC(mod::osReportLW, LW(7))
        IF_EQUAL(LW(7), 3)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_EFFECT_SMALL1"))
        USER_FUNC(calc_peach_heal, LW(7))
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("peach_heal_success"), LW(7))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
        USER_FUNC(spm::evt_pouch::evt_pouch_add_hp, 20)
        ELSE()
          RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
        END_IF()
    CASE_EQUAL(2) //Bowser
        USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_014"))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_KOOPA_FIRE1"))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_KOOPA_FLAME1"))
        USER_FUNC(spm::evt_snd::evt_snd_get_last_sfx_id, LW(0))
        WAIT_MSEC(600)
        USER_FUNC(spm::evt_snd::func_800d2fa4, LW(0), 1000)
        SET(LW(10), LW(4))
        RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_015"), LW(3))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    CASE_EQUAL(3) //Luigi
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_017"), LW(3))
        USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
        IF_SMALL(LW(10), 150)
            SET(LW(10), LW(4))
            RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_019"))
        ELSE()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_LUIGI_SUPERJUMP_SET1"))
            WAIT_MSEC(300)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_LUIGI_SUPERJUMP_SET2"))
            WAIT_MSEC(300)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_LUIGI_SUPERJUMP_SET3"))
            WAIT_MSEC(300)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_LUIGI_SUPERJUMP1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_V_LUIGI_SJUMP1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_P_V_LUIGI_SJUMP1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
            SET(LW(10), LW(4))
            RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 4, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_018"), LW(3), LW(10))
            USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
            RUN_CHILD_EVT(runEnemyDeath)
            USER_FUNC(spm::evt_msg::evt_msg_continue)
        END_IF()
END_SWITCH()
SET(LW(0), 5)
USER_FUNC(enable_disable_rpg_menu, 0)
RETURN()
EVT_END()

EVT_BEGIN(pixls)
    SET(UW(0), LW(4))
    SWITCH(LW(2))
        CASE_EQUAL(220) //Tippi
            SET(LW(12), 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 1, PTR(tippi_pacify))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_PANSY_SING1"))
            BROTHER_EVT_ID(LW(2))
              USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 0, LW(10))
              IF_NOT_FLAG(LW(10), 0x8000)
                USER_FUNC(get_rpg_enemy_death_script, 0, LW(3))
                IF_EQUAL(LW(3), 0)
                  SET(LW(10), 0)
                  USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, 0, 0, LW(11))
                  USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 0, LW(11), 0, LW(0))
                  IF_FLAG(LW(0), 0x8000)
                    USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc1"), 4, 1)
                    INLINE_EVT_ID(LW(10))
                      SET(LW(9), FLOAT(0.0))
                      DO(0)
                      ADDF(LW(9), FLOAT(9.0))
                      USER_FUNC(spm::evt_npc::evt_npc_rotate, PTR("npc1"), EVT_NULLPTR, LW(9), EVT_NULLPTR)
                      WAIT_FRM(1)
                      WHILE()
                    END_INLINE()
                    WAIT_MSEC(1000)
                    DELETE_EVT(LW(10))
                    USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc1"), LW(5), LW(6), LW(7))
                    USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("kemuri_test"), 13, LW(5), LW(6), LW(7), FLOAT(2.0), 0, 0, 0, 0, 0, 0, 0)
                    USER_FUNC(spm::evt_npc::evt_npc_delete, PTR("npc1"))
                    USER_FUNC(spm::evt_mobj::evt_mobj_delete, PTR("mobj1"))
                    ADD(UW(5), 1)
                  ELSE()
                    MUL(LW(11), -1)
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 0, LW(11), 0, LW(0))
                  END_IF()
                END_IF()
              END_IF()
            END_BROTHER()
            BROTHER_EVT_ID(LW(8))
              USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 1, LW(10))
              IF_NOT_FLAG(LW(10), 0x8000)
                USER_FUNC(get_rpg_enemy_death_script, 1, LW(3))
                IF_EQUAL(LW(3), 0)
                  SET(LW(10), 1)
                  USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, 1, 0, LW(11))
                  USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 1, LW(11), 0, LW(0))
                  IF_FLAG(LW(0), 0x8000)
                    USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc2"), 4, 1)
                    INLINE_EVT_ID(LW(10))
                      SET(LW(9), FLOAT(0.0))
                      DO(0)
                      ADDF(LW(9), FLOAT(9.0))
                      USER_FUNC(spm::evt_npc::evt_npc_rotate, PTR("npc2"), EVT_NULLPTR, LW(9), EVT_NULLPTR)
                      WAIT_FRM(1)
                      WHILE()
                    END_INLINE()
                    WAIT_MSEC(1000)
                    DELETE_EVT(LW(10))
                    USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc2"), LW(5), LW(6), LW(7))
                    USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("kemuri_test"), 13, LW(5), LW(6), LW(7), FLOAT(2.0), 0, 0, 0, 0, 0, 0, 0)
                    USER_FUNC(spm::evt_npc::evt_npc_delete, PTR("npc2"))
                    USER_FUNC(spm::evt_mobj::evt_mobj_delete, PTR("mobj2"))
                    ADD(UW(5), 1)
                  ELSE()
                    MUL(LW(11), -1)
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 1, LW(11), 0, LW(0))
                  END_IF()
                END_IF()
              END_IF()
            END_BROTHER()
            BROTHER_EVT_ID(LW(10))
              USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 2, LW(10))
              IF_NOT_FLAG(LW(10), 0x8000)
                USER_FUNC(get_rpg_enemy_death_script, 2, LW(3))
                IF_EQUAL(LW(3), 0)
                  SET(LW(10), 2)
                  USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, 2, 0, LW(11))
                  USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 2, LW(11), 0, LW(0))
                  IF_FLAG(LW(0), 0x8000)
                    USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc3"), 4, 1)
                    INLINE_EVT_ID(LW(10))
                      SET(LW(9), FLOAT(0.0))
                      DO(0)
                      ADDF(LW(9), FLOAT(9.0))
                      USER_FUNC(spm::evt_npc::evt_npc_rotate, PTR("npc3"), EVT_NULLPTR, LW(9), EVT_NULLPTR)
                      WAIT_FRM(1)
                      WHILE()
                    END_INLINE()
                    WAIT_MSEC(1000)
                    DELETE_EVT(LW(10))
                    USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc3"), LW(5), LW(6), LW(7))
                    USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("kemuri_test"), 13, LW(5), LW(6), LW(7), FLOAT(2.0), 0, 0, 0, 0, 0, 0, 0)
                    USER_FUNC(spm::evt_npc::evt_npc_delete, PTR("npc3"))
                    USER_FUNC(spm::evt_mobj::evt_mobj_delete, PTR("mobj3"))
                    ADD(UW(5), 1)
                  ELSE()
                    MUL(LW(11), -1)
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 2, LW(11), 0, LW(0))
                  END_IF()
                END_IF()
              END_IF()
            END_BROTHER()
            DO(0)
              CHK_EVT(LW(2), LW(0))
              IF_EQUAL(LW(0), 0)
                DO_BREAK()
              END_IF()
              WAIT_FRM(1)
            WHILE()
            DO(0)
              CHK_EVT(LW(8), LW(0))
              IF_EQUAL(LW(0), 0)
                DO_BREAK()
              END_IF()
              WAIT_FRM(1)
            WHILE()
            DO(0)
              CHK_EVT(LW(10), LW(0))
              IF_EQUAL(LW(0), 0)
                DO_BREAK()
              END_IF()
              WAIT_FRM(1)
            WHILE()
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 1, PTR(tippi_pacify_success), UW(5))
            USER_FUNC(spm::evt_msg::evt_msg_continue)
        CASE_EQUAL(221) //Thoreau
            SET(LW(12), 0)
            SET(UW(0), LW(4))
            SWITCH(LW(4))
              CASE_EQUAL(0)
                SET(LW(15), PTR("npc1"))
              CASE_EQUAL(1)
                SET(LW(15), PTR("npc2"))
              CASE_EQUAL(2)
                SET(LW(15), PTR("npc3"))
            END_SWITCH()
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 221)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(mod::getFP, LW(5))
            IF_LARGE(LW(5), 0)
                USER_FUNC(mod::subtractFP, 1)
                USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 3)
                USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
                USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
                USER_FUNC(enable_disable_rpg_menu, 0)
                USER_FUNC(spm::evt_msg::evt_msg_continue)
                SWITCH(LW(7))
                  CASE_EQUAL(3)
                    ADD(LW(9), 901)
                END_SWITCH()
            END_IF()
            IF_LARGE(LW(9), 900)
                USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(7))
                IF_SMALL_EQUAL(LW(7), 1001)
                  USER_FUNC(spm::evt_npc::evt_npc_get_position, LW(15), LW(5), LW(6), LW(7))
                  ADD(LW(6), 20)
                  USER_FUNC(spm::evt_fairy::evt_fairy_all_enter_run_mode1)
                  USER_FUNC(spm::evt_fairy::evt_fairy_fly_to, 0, LW(5), LW(6), LW(7), 500)
                  WAIT_FRM(1)
                  USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_1"))
                  USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                  USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_NAGE_FIRLING1"))
                  USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_2B"))
                  INLINE_EVT()
                    ADD(LW(6), 30)
                    USER_FUNC(spm::evt_npc::evt_npc_set_anim, LW(15), 4, 1)
                    USER_FUNC(spm::evt_npc::evt_npc_glide_to, LW(15), LW(5), LW(6), LW(7), 0, FLOAT(380.0), 0, 0, 0, 0)
                  END_INLINE()
                  SET(LW(9), FLOAT(0.0))
                  DO(0)
                    ADDF(LW(9), FLOAT(30.0))
                    IF_LARGE(LW(9), 180)
                      SET(LW(9), 180)
                    END_IF()
                    USER_FUNC(spm::evt_npc::evt_npc_rotate, LW(15), EVT_NULLPTR, EVT_NULLPTR, LW(9))
                    WAIT_FRM(1)
                    IF_EQUAL(LW(9), 180)
                      DO_BREAK()
                    END_IF()
                  WHILE()
                  ADD(LW(4), 1)
                  WAIT_FRM(10)
                  LBL(33)
                  SWITCH(LW(4))
                    CASE_EQUAL(1)
                      SET(LW(14), PTR("npc2"))
                    CASE_EQUAL(2)
                      SET(LW(14), PTR("npc3"))
                  END_SWITCH()
                  IF_SMALL_EQUAL(LW(4), 2)
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), 0, 0, LW(0))
                    IF_NOT_FLAG(LW(0), 0x8000)
                      USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_3C"))
                      INLINE_EVT()
                        ADD(LW(6), 30)
                        USER_FUNC(spm::evt_fairy::evt_fairy_fly_to, 0, LW(5), LW(6), LW(7), 100)
                      END_INLINE()
                      BROTHER_EVT_ID(LW(12))
                        USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                        USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_4A"))
                        USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                        USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("S_1"))
                        USER_FUNC(ac_success_reset)
                        INLINE_EVT()
                          SET(LW(10), 0)
                          LBL(1)
                              USER_FUNC(check_pressed_a_ac, LW(11))
                              USER_FUNC(enable_disable_stylish, 1)
                              IF_EQUAL(LW(11), 1)
                                USER_FUNC(ac_success_toggle)
                                GOTO(2)
                              END_IF()
                            WAIT_FRM(1)
                            ADD(LW(10), 1)
                            IF_EQUAL(LW(10), 10)
                              GOTO(2)
                            END_IF()
                          GOTO(1)
                          LBL(2)
                          USER_FUNC(enable_disable_stylish, 0)
                        END_INLINE()
                        WAIT_FRM(10)
                        USER_FUNC(check_ac_success, LW(11))
                            IF_EQUAL(LW(11), 1)
                                USER_FUNC(spm::evt_sub::evt_sub_random, 100, LW(5))
                                ADD(LW(5), 50)
                                USER_FUNC(spm::an2_08::evt_rpg_add_xp, LW(5))
                                USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
                                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_ACROBAT_RENZOKU1"))
                                USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("nice"), UW(6), 150, 0, 0, FLOAT(1.0), 0, 0, 0, 0, 0, 0, 0) 
                                RUN_CHILD_EVT(increase_stylish)
                                SET(LW(5), UW(4))
                                USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_4A"))
                                USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                                USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("S_1"))
                            END_IF()
                      END_BROTHER()
                      USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_BOMB_THROW1"))
                      ADD(LW(6), 10)
                      USER_FUNC(spm::evt_npc::evt_npc_get_position, LW(14), LW(5), LW(6), LW(7))
                      USER_FUNC(spm::evt_npc::evt_npc_jump_to, LW(15), LW(5), LW(6), LW(7), 75, FLOAT(500.0))
                      USER_FUNC(spm::evt_npc::evt_npc_get_position, LW(14), LW(5), LW(6), LW(7))
                      USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 0, LW(10))
                      ADD(LW(10), 2)
                      SET(LW(2), LW(4))
                      SET(LW(8), LW(4))
                      RUN_EVT(damageAnims)
                      USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
                      USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                      USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
                      USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 0, LW(0))
                      USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 1, LW(1))
                      USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 2, LW(2))
                      ADD(LW(1), 20)
                      USER_FUNC(spm::evt_npc::evt_npc_jump_to, LW(15), LW(0), LW(1), LW(2), 75, FLOAT(500.0))
                      SET(LW(4), UW(0))
                      SET(LW(2), LW(4))
                      RUN_EVT(damageAnims)
                      USER_FUNC(displayDamage, LW(0), LW(1), LW(2), LW(10))
                      USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                      USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
                      WAIT_FRM(15)
                      INLINE_EVT()
                        USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 0, LW(0))
                        SUB(LW(1), 20)
                        USER_FUNC(spm::evt_npc::evt_npc_jump_to, LW(15), LW(0), LW(1), LW(2), 25, FLOAT(500.0))
                        USER_FUNC(spm::evt_npc::evt_npc_set_position, LW(15), LW(0), LW(1), LW(2))
                      END_INLINE()
                      WAIT_FRM(4)
                      DO(0)
                        SUBF(LW(9), FLOAT(30.0))
                        IF_SMALL(LW(9), 0)
                          SET(LW(9), 0)
                        END_IF()
                        USER_FUNC(spm::evt_npc::evt_npc_rotate, LW(15), EVT_NULLPTR, EVT_NULLPTR, LW(9))
                        WAIT_FRM(1)
                        IF_EQUAL(LW(9), 0)
                          DO_BREAK()
                        END_IF()
                      WHILE()
                      SET(LW(4), UW(0))
                      SET(UW(0), LW(8))
                      USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, UW(0), 0, 0, LW(0))
                      RUN_CHILD_EVT(runEnemyDeath)
                      SET(UW(0), LW(4))
                      USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, UW(0), 0, 0, LW(0))
                    ELSE()
                      ADD(LW(4), 1)
                      GOTO(33)
                    END_IF()
                  ELSE()
                    USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_3C"))
                    INLINE_EVT()
                      ADD(LW(6), 30)
                      USER_FUNC(spm::evt_fairy::evt_fairy_fly_to, 0, LW(5), LW(6), LW(7), 100)
                    END_INLINE()
                    BROTHER_EVT_ID(LW(12))
                      USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                      USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_4A"))
                      USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                      USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("S_1"))
                      USER_FUNC(ac_success_reset)
                      INLINE_EVT()
                        SET(LW(10), 0)
                        LBL(1)
                            USER_FUNC(check_pressed_a_ac, LW(11))
                            USER_FUNC(enable_disable_stylish, 1)
                            IF_EQUAL(LW(11), 1)
                              USER_FUNC(ac_success_toggle)
                              GOTO(2)
                            END_IF()
                          WAIT_FRM(1)
                          ADD(LW(10), 1)
                          IF_EQUAL(LW(10), 10)
                            GOTO(2)
                          END_IF()
                        GOTO(1)
                        LBL(2)
                        USER_FUNC(enable_disable_stylish, 0)
                      END_INLINE()
                      WAIT_FRM(10)
                      USER_FUNC(check_ac_success, LW(11))
                          IF_EQUAL(LW(11), 1)
                              USER_FUNC(spm::evt_sub::evt_sub_random, 100, LW(5))
                              ADD(LW(5), 50)
                              USER_FUNC(spm::an2_08::evt_rpg_add_xp, LW(5))
                              USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
                              USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_ACROBAT_RENZOKU1"))
                              USER_FUNC(spm::evt_eff::evt_eff, 0, PTR("nice"), UW(6), 150, 0, 0, FLOAT(1.0), 0, 0, 0, 0, 0, 0, 0) 
                              RUN_CHILD_EVT(increase_stylish)
                              SET(LW(5), UW(4))
                            USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("A_4A"))
                            USER_FUNC(spm::evt_fairy::evt_fairy_wait_anim_end, 0)
                            USER_FUNC(spm::evt_fairy::evt_fairy_set_anim, 0, PTR("S_1"))
                          END_IF()
                    END_BROTHER()
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_BOMB_THROW1"))
                    USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 0, LW(0))
                    USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 1, LW(1))
                    USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 2, LW(2))
                    ADD(LW(1), 20)
                    USER_FUNC(spm::evt_npc::evt_npc_jump_to, LW(15), LW(0), LW(1), LW(2), 75, FLOAT(500.0))
                    SET(LW(4), UW(0))
                    SET(LW(2), LW(4))
                    RUN_EVT(damageAnims)
                    USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, UW(0), 0, LW(10))
                    ADD(LW(10), 2)
                    USER_FUNC(displayDamage, LW(0), LW(1), LW(2), LW(10))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
                    WAIT_FRM(15)
                    INLINE_EVT()
                      USER_FUNC(spm::evt_npc::evt_npc_get_unitwork, LW(15), 0, LW(0))
                      SUB(LW(1), 20)
                      USER_FUNC(spm::evt_npc::evt_npc_jump_to, LW(15), LW(0), LW(1), LW(2), 25, FLOAT(500.0))
                      USER_FUNC(spm::evt_npc::evt_npc_set_position, LW(15), LW(0), LW(1), LW(2))
                    END_INLINE()
                    WAIT_FRM(4)
                    DO(0)
                      SUBF(LW(9), FLOAT(30.0))
                      IF_SMALL(LW(9), 0)
                        SET(LW(9), 0)
                      END_IF()
                      USER_FUNC(spm::evt_npc::evt_npc_rotate, LW(15), EVT_NULLPTR, EVT_NULLPTR, LW(9))
                      WAIT_FRM(1)
                      IF_EQUAL(LW(9), 0)
                        DO_BREAK()
                      END_IF()
                    WHILE()
                  END_IF()
                ELSE()
                  SET(LW(10), LW(4))
                  USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_023"), LW(3))
                END_IF()
                DO(0)
                  CHK_EVT(LW(12), LW(1))
                  IF_EQUAL(LW(1), 0)
                    DO_BREAK()
                  END_IF()
                  WAIT_FRM(1)
                WHILE()
                USER_FUNC(spm::evt_fairy::evt_fairy_all_enter_run_mode2)
            ELSE()
              USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_EVT_HELWANWAN_MISS1"))
              USER_FUNC(mod::addFP, 1)
            END_IF()
            SET(LW(1), LW(3))
        CASE_EQUAL(222) //Boomer
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 222)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_025"), LW(10))
            INLINE_EVT()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_BOMB_FUSE1"))
            USER_FUNC(spm::evt_snd::evt_snd_get_last_sfx_id, LW(0))
            WAIT_MSEC(600)
            USER_FUNC(spm::evt_snd::evt_snd_sfxoff, LW(0))
            END_INLINE()
            USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
            USER_FUNC(mod::getFP, LW(5))
            IF_LARGE(LW(5), 0)
                USER_FUNC(mod::subtractFP, 1)
                USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
                USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
                USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
                USER_FUNC(mod::osReportLW, LW(7))
                SWITCH(LW(7))
                  CASE_EQUAL(5)
                    ADD(LW(10), 901)
                END_SWITCH()
            ELSE()
              USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
              USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
              USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
              SWITCH(LW(7))
                CASE_EQUAL(5)
                  SET(LW(7), 5)
                CASE_ETC()
                  SET(LW(10), 0)
              END_SWITCH()
            END_IF()
            IF_SMALL(LW(10), 900)
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_026"))
            ELSE()
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_BOMB_FIRE1"))
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 20, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_027"), LW(3), LW(10))
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
            END_IF()
        CASE_EQUAL(223) //Slim
        USER_FUNC(mod::getFP, LW(5))
        IF_LARGE(LW(5), 0)
            USER_FUNC(mod::subtractFP, 1)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_028"), LW(10))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_SLIT_RETURN1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_SLIT_RETURN1"))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_029"), LW(10))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 1)
        END_IF()
        CASE_EQUAL(224) //Thudley
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 224)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_032"), LW(10))
            INLINE_EVT()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_MARIO_JUMP1"), PTR("SFX_P_PEACH_JUMP1"), PTR("SFX_P_KOOPA_JUMP1"), PTR("SFX_P_LUIGI_JUMP1"))
            END_INLINE()
            USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
            USER_FUNC(mod::getFP, LW(5))
            IF_LARGE(LW(5), 1)
                USER_FUNC(mod::subtractFP, 2)
                USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
                USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
                USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
                USER_FUNC(mod::osReportLW, LW(7))
                SWITCH(LW(7))
                  CASE_EQUAL(5)
                    ADD(LW(10), 901)
                END_SWITCH()
            ELSE()
              USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
              USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
              USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
              SWITCH(LW(7))
                CASE_EQUAL(5)
                  SET(LW(7), 5)
                CASE_ETC()
                  SET(LW(10), 0)
              END_SWITCH()
            END_IF()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_MARIO_HIPDROP_ROLL1"), PTR("SFX_P_PEACH_HIPDROP_ROLL1"), PTR("SFX_P_KOOPA_HIPDROP_ROLL1"), PTR("SFX_P_LUIGI_HIPDROP_ROLL1"))
            WAIT_MSEC(500)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_MARIO_HIPDROP1"), PTR("SFX_P_PEACH_HIPDROP1"), PTR("SFX_P_KOOPA_HIPDROP1"), PTR("SFX_P_LUIGI_HIPDROP1"))
            IF_SMALL(LW(10), 900)
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_034"))
            ELSE()
                USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_V_MARIO_ATTACK1"), PTR("SFX_P_V_PEACH_ATTACK1"), PTR("SFX_P_V_KOOPA_ATTACK1"), PTR("SFX_P_V_LUIGI_ATTACK1"))
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 15, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_033"), LW(3), LW(10))
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
            END_IF()
        CASE_EQUAL(225) //Carrie
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 225)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_035"), LW(10))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_MARIO_JUMP1"), PTR("SFX_P_PEACH_JUMP1"), PTR("SFX_P_KOOPA_JUMP1"), PTR("SFX_P_LUIGI_JUMP1"))
            WAIT_MSEC(500)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_036"))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 2)
        CASE_EQUAL(226) //Fleep
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 226)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_038"), LW(10), LW(3))
            INLINE_EVT()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_MEKURI_DRAW1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_MEKURI_DRAW1"))
            END_INLINE()
            USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
            USER_FUNC(mod::getFP, LW(5))
            IF_LARGE(LW(5), 0)
                USER_FUNC(mod::subtractFP, 1)
                USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
                USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
                USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
                USER_FUNC(mod::osReportLW, LW(7))
                SWITCH(LW(7))
                  CASE_EQUAL(5)
                    ADD(LW(10), 901)
                END_SWITCH()
            ELSE()
              USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
              USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
              USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
              SWITCH(LW(7))
                CASE_EQUAL(5)
                  SET(LW(7), 5)
                CASE_ETC()
                  SET(LW(10), 0)
              END_SWITCH()
            END_IF()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_MEKURI_TURN1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_MEKURI_DRAW1"))
            IF_SMALL(LW(10), 900)
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_040"), LW(3))
            ELSE()
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(4), LW(10))
                IF_FLAG(LW(10), 0x3)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_042"), LW(3))
                ELSE()
                    SET(LW(10), LW(4))
                    RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), 0, 4, LW(0))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_039"), LW(3))
                END_IF()
            END_IF()
        CASE_EQUAL(227) //Cudge
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 227)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_044"), LW(10), LW(3))
            USER_FUNC(enable_disable_rpg_menu, 0)
            USER_FUNC(spm::evt_msg::evt_msg_continue)
            USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(5), LW(6), LW(7))
            SET(LW(5), UW(4))
            ADD(LW(5), 150)
            INLINE_EVT()
              SET(LW(10), UW(3))
              SUB(LW(10), 25)
              USER_FUNC(spm::evt_cam::evt_cam3d_evt_zoom_in, 0, LW(5), EVT_NULLPTR, LW(10), LW(5), EVT_NULLPTR, 200, 1000, 11)
            END_INLINE()
            SWITCH(LW(4))
                CASE_EQUAL(0)
                  USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc1"), LW(5), LW(6), LW(7))
                CASE_EQUAL(1)
                  USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc2"), LW(5), LW(6), LW(7))
                CASE_EQUAL(2)
                  USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc3"), LW(5), LW(6), LW(7))
            END_SWITCH()
            SUB(LW(5), 35)
            INLINE_EVT()
                USER_FUNC(spm::evt_mario::evt_mario_pos_change, LW(5), LW(7), FLOAT(180.0))
                WAIT_FRM(2)
                USER_FUNC(spm::evt_mario::evt_mario_get_character, LW(5))
                IF_EQUAL(LW(5), 0)
                    USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("H_1A"), 0)
                END_IF()
                IF_EQUAL(LW(5), 1)
                    USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("H_1B"), 0)
                END_IF()
                IF_EQUAL(LW(5), 2)
                    USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("H_1A"), 0)
                END_IF()
                IF_EQUAL(LW(5), 3)
                    USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("H_1B"), 0)
                END_IF()
            END_INLINE()
            USER_FUNC(mod::getFP, LW(5))
            IF_LARGE(LW(5), 0)
                USER_FUNC(mod::subtractFP, 1)
                USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
                USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
                USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
                USER_FUNC(mod::osReportLW, LW(7))
                SWITCH(LW(7))
                  CASE_EQUAL(5)
                    SET(LW(10), 1)
                END_SWITCH()
            ELSE()
              USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
              USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
              USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
              SWITCH(LW(7))
                CASE_EQUAL(5)
                  SET(LW(7), 5)
                CASE_ETC()
                  SET(LW(10), 0)
              END_SWITCH()
            END_IF()
            USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("H_1C"), 0)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_HAMMER_SWING1"))
            IF_SMALL(LW(10), 1)
                SET(LW(10), LW(4))
                RUN_EVT(mod::rpg_snd_miss_evt)
                WAIT_FRM(5)
                RUN_CHILD_EVT(end_of_turn_stylish)
                USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_046"), LW(3))
            ELSE()
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_HAMMER_HIT1"))
                SET(LW(10), LW(4))
                RUN_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                SET(LW(2), LW(4))
                RUN_EVT(damageAnims)
                USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 1, LW(10))
                MUL(LW(10), 2)
                SWITCH(LW(4))
                    CASE_EQUAL(0)
                      USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc1"), LW(5), LW(6), LW(7))
                      USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
                    CASE_EQUAL(1)
                      USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc2"), LW(5), LW(6), LW(7))
                      USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
                    CASE_EQUAL(2)
                      USER_FUNC(spm::evt_npc::evt_npc_get_position, PTR("npc3"), LW(5), LW(6), LW(7))
                      USER_FUNC(displayDamage, LW(5), LW(6), LW(7), LW(10))
                END_SWITCH()
                WAIT_FRM(5)
                RUN_CHILD_EVT(end_of_turn_stylish)
                USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_045"), LW(3), LW(10))
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
            END_IF()
        CASE_EQUAL(228) //Dottie
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 228)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_047"), LW(10))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_MINI_CURSOR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_MINI_CURSOR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_MINI_SYUKUSYO1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_MINI_SYUKUSYO1"))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_048"), LW(10))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 4)
        CASE_EQUAL(229) //Piccolo
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 229)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_050"), LW(10))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_F_PIKKYORON_MARIO1"), PTR("SFX_F_PIKKYORON_PEACH1"), PTR("SFX_F_PIKKYORON_KUPPA1"), PTR("SFX_F_PIKKYORON_LUIGI1"))
            USER_FUNC(spm::evt_snd::evt_snd_get_last_sfx_id, LW(5))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait, LW(5))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_PIKKYORON_SHINE1"))
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_051"))
            USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(10))
            IF_FLAG(LW(10), 0x7800)
                USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_065"), LW(10))
                USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 30720)
            END_IF()
            USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 0, LW(10))
            IF_NOT_FLAG(LW(10), 0x8000)
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_NEMURE_SUCCESS1"))
                SET(LW(10), 0)
                RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 0, 0, 2, LW(0))
                USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 0, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_052"), LW(10))
            END_IF()
            USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 1, LW(10))
            IF_NOT_FLAG(LW(10), 0x8000)
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_NEMURE_SUCCESS1"))
                SET(LW(10), 1)
                RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 1, 0, 2, LW(0))
                USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 1, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_052"), LW(10))
            END_IF()
            USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 2, LW(10))
            IF_NOT_FLAG(LW(10), 0x8000)
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_NEMURE_SUCCESS1"))
                SET(LW(10), 2)
                RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, 2, 0, 2, LW(0))
                USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 2, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_052"), LW(10))
            END_IF()
        CASE_EQUAL(230) //Barry
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 230)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_054"), LW(3))
            INLINE_EVT()
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_COUNTER_TURN1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_COUNTER_TURN1"))
            END_INLINE()
            USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
            USER_FUNC(mod::getFP, LW(5))
            IF_LARGE(LW(5), 0)
              USER_FUNC(mod::subtractFP, 1)
              USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
              USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
              USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
              USER_FUNC(mod::osReportLW, LW(7))
              SWITCH(LW(7))
                CASE_EQUAL(5)
                  ADD(LW(10), 901)
                  END_SWITCH()
            ELSE()
              USER_FUNC(spm::evt_ac::evt_ac_entry, PTR("ac"), 2)
              USER_FUNC(spm::evt_ac::evt_ac_return_results, PTR("ac"), LW(7))
              USER_FUNC(spm::evt_ac::evt_ac_delete, PTR("ac"))
              SWITCH(LW(7))
                CASE_EQUAL(5)
                SET(LW(7), 5)
              CASE_ETC()
                SET(LW(10), 0)
              END_SWITCH()
            END_IF()
            IF_SMALL(LW(10), 900)
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
                USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_056"))
            ELSE()
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                SET(LW(10), LW(4))
                RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 108, LW(10))
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_055"), LW(3), LW(10))
                USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 64)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
            END_IF()
        CASE_EQUAL(231) //Dashell
            USER_FUNC(spm::evt_pouch::evt_pouch_set_pixl_selected, 231)
            USER_FUNC(spm::evt_fairy::evt_fairy_reset)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_056_01"), LW(10))
            WAIT_MSEC(500)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_056_02"), LW(10))
    END_SWITCH()
    RUN_CHILD_EVT(runEnemyDeath)
    USER_FUNC(enable_disable_rpg_menu, 0)
    RETURN()
EVT_END()

EVT_BEGIN(items)
    SET(UW(0), LW(4))
    USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
    USER_FUNC(spm::evt_msg::evt_msg_fmt_str, 0, LW(15), PTR("stg7_2_133_2_061"), LW(1))
    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 1, LW(15), LW(10), LW(1))
    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_ITEM_USE1"))
    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_ITEM_USE1"))
    USER_FUNC(spm::evt_pouch::evt_pouch_remove_item, LW(2))
    SET(LF(0), 0)
    LBL(1)
    SWITCH(LW(2))
        CASE_OR(87)
        CASE_OR(88)
        CASE_OR(79)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_062"))
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_EQUAL(70)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_078"), LW(10))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_KICK_KOURA1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_E_KICK_KOURA1"))
            WAIT_MSEC(500)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_CRUSH1"))
            SET(LW(10), LW(4))
            RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(4), 13, LW(10))
            ADD(LW(10), 5)
            USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_079"), LW(3), LW(10))
            USER_FUNC(spm::evt_msg::evt_msg_continue)
            USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(4), LW(10), 0, LW(0))
            RUN_CHILD_EVT(runEnemyDeath)
            USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
    END_SWITCH()
    SWITCH(LW(2))
        CASE_EQUAL(77)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_080"), LW(10))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_OBAKE_APPEAR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_OBAKE_APPEAR2"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_OBAKE_APPEAR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_OBAKE_APPEAR2"))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_081"), LW(3))
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(65)
        CASE_OR(160)
        CASE_OR(161)
            SET(LW(5), 0)
            DO(3)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(5), LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_FIRE1_1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_FIRE1_1"))
                    SET(LW(10), LW(5))
                    //RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
                    //USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                    //USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_073"), LW(10))
                    USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 8, LW(10))
                    IF_EQUAL(LW(10), 0)
                      RUN_CHILD_EVT(mod::rpg_snd_miss_evt)
                      USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                      USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_073"), LW(10))
                    ELSE()
                        // todo make this hurt enemies
                    END_IF()
                ADD(LW(5), 1)
                END_IF()
            WHILE()
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(66)
        CASE_OR(148)
        CASE_OR(149)
        CASE_OR(147)
        CASE_OR(146)
            SET(LW(5), 0)
            DO(3)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(5), LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_ICE1_1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_ICE1_1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_ICE1_2"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                    SET(LW(10), LW(5))
                    RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                    SWITCH(LW(2))
                        CASE_EQUAL(66)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 101, LW(11))
                        CASE_EQUAL(148)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 105, LW(11))
                        CASE_EQUAL(149)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 106, LW(11))
                        CASE_EQUAL(147)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 105, LW(11))
                        CASE_EQUAL(146)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 106, LW(11))
                    END_SWITCH()
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_074"), LW(10), LW(11))
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(5), LW(11), 0, LW(0))
                    RUN_CHILD_EVT(runEnemyDeath)
                END_IF()
                ADD(LW(5), 1)
            WHILE()
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_EQUAL(67)
            SET(LW(5), 0)
            DO(3)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(5), LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_THUNDER1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_THUNDER1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                    SET(LW(10), LW(5))
                    //RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                    USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 102, LW(11))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_075"), LW(10), LW(11))
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(5), LW(11), 0, LW(0))
                    RUN_CHILD_EVT(runEnemyDeath)
                END_IF()
                ADD(LW(5), 1)
            WHILE()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(68)
        CASE_OR(163)
            SET(LW(5), 0)
            DO(3)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(5), LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KIRAKIRA1"))
                    WAIT_MSEC(200)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KIRAKIRA1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_KIRAKIRA1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                    SET(LW(10), LW(5))
                    RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                    SWITCH(LW(2))
                        CASE_EQUAL(68)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 103, LW(11))
                        CASE_EQUAL(163)
                            USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 107, LW(11))
                    END_SWITCH()
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_076"), LW(10), LW(11))
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(5), LW(11), 0, LW(0))
                    RUN_CHILD_EVT(runEnemyDeath)
                END_IF()
                ADD(LW(5), 1)
            WHILE()
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(69)
        CASE_OR(214)
            SET(LW(5), 0)
            DO(3)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(5), LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_POW_APPEAR1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_POW_APPEAR1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_POW_ATTACK1"))
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_MARIO_JUMP1"), PTR("SFX_P_PEACH_JUMP1"), PTR("SFX_P_KOOPA_JUMP1"), PTR("SFX_P_LUIGI_JUMP1"))
                    WAIT_MSEC(200)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_E_SMASH1"))
                    SET(LW(10), LW(5))
                    RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                    USER_FUNC(spm::an2_08::evt_rpg_calc_damage_to_enemy, LW(5), 104, LW(11))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_077"), LW(10), LW(11))
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(5), LW(11), 0, LW(0))
                    RUN_CHILD_EVT(runEnemyDeath)
                END_IF()
                ADD(LW(5), 1)
            WHILE()
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(73)
        CASE_OR(206)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_BARRIER_APPEAR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_BARRIER_APPEAR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_BARRIER_APPEAR2"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_072"), LW(5))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 16)
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(74)
        CASE_OR(153)
        CASE_OR(182)
        CASE_OR(157)
        CASE_OR(140)
        CASE_OR(198)
        CASE_OR(158)
        CASE_OR(215)
        CASE_OR(104)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KATIKATI_APPEAR1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_KATIKATI_APPEAR1"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_071"), LW(5))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 64)
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(75)
        CASE_OR(181)
        CASE_OR(183)
        CASE_OR(155)
        CASE_OR(162)
        CASE_OR(124)
        CASE_OR(158)
        CASE_OR(215)
        CASE_OR(109)
        CASE_OR(113)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_TUYOTUYO1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_TUYOTUYO1"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_068"), LW(5))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 256)
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(76)
        CASE_OR(151)
        CASE_OR(158)
        CASE_OR(215)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_BIRIBIRI1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_BIRIBIRI1"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_070"), LW(5))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 128)
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(78)
        CASE_OR(208)
        CASE_OR(176)
            SET(LW(5), 0)
            DO(3)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, LW(5), LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_NEMURE_SUCCESS1"))
                    SET(LW(10), LW(5))
                    RUN_CHILD_EVT(mod::rpg_snd_hit_evt)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, LW(5), LW(10))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_082"), LW(10))
                    USER_FUNC(spm::an2_08::evt_rpg_enemy_take_damage, LW(5), 0, 1, LW(10))
                END_IF()
                ADD(LW(5), 1)
            WHILE()
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_OR(85)
        CASE_OR(123)
        CASE_OR(135)
        CASE_OR(194)
        CASE_OR(198)
        CASE_OR(124)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_JIWAJIWA_SHINE1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_JIWAJIWA_SHINE1"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_069"), LW(5))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 32)
            CASE_END()
    END_SWITCH()
    SWITCH(LW(2))
        CASE_EQUAL(86)
            USER_FUNC(spm::an2_08::evt_rpg_get_item_msg, LW(1), LW(2))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_sub::evt_sub_get_language, LW(15))
            SWITCH(LW(15))
                CASE_EQUAL(0)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_083"), LW(1), LW(5), LW(1))
                CASE_ETC()
                    USER_FUNC(spm::evt_msg::evt_msg_fmt_str, 0, LW(15), PTR("stg7_2_133_2_083"), LW(1))
                    USER_FUNC(spm::evt_msg::evt_msg_fmt_str, 1, LW(14), LW(15), LW(1))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 1, LW(14), LW(5))
            END_SWITCH()
            IF_EQUAL(LW(2), 70)
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 0, LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 0, LW(3))
                    SET(LW(4), 0)
                END_IF()
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 1, LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 1, LW(3))
                    SET(LW(4), 1)
                END_IF()
                USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 2, LW(10))
                IF_NOT_FLAG(LW(10), 0x8000)
                    USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 2, LW(3))
                    SET(LW(4), 2)
                END_IF()
            END_IF()
            SET(LF(0), 1)
    END_SWITCH()
    IF_EQUAL(LF(0), 1)
        SET(LF(0), 0)
        GOTO(1)
    END_IF()
    SWITCH(LW(2))
        CASE_EQUAL(89)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_HEART_HUERU1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_HEART_HUERU1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_HEART_HUERU2"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_084"), LW(5))
            USER_FUNC(spm::evt_pouch::evt_pouch_get_max_hp, LW(5))
            ADD(LW(5), 5)
            USER_FUNC(spm::evt_pouch::evt_pouch_set_max_hp, LW(5))
    END_SWITCH()
    SWITCH(LW(2))
        CASE_EQUAL(90)
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_HPOWER_PLUS1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_I_HPOWER_PLUS1"))
            USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_HPOWER_PLUS2"))
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_085"), LW(5))
            USER_FUNC(spm::evt_pouch::evt_pouch_add_attack, 1)
    END_SWITCH()
    SWITCH(LW(2))
        CASE_EQUAL(174)
            RUN_CHILD_EVT(mod::marioRPGtakeDamage)
            USER_FUNC(spm::evt_pouch::evt_pouch_get_hp, LW(10))
            SUB(LW(10), 1)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(3))
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_094"), LW(3), LW(10))
            USER_FUNC(spm::an2_08::evt_rpg_mario_take_damage, LW(10), 0, LW(0))
    END_SWITCH()
    SWITCH(LW(2))
        CASE_ETC()
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(5))
            USER_FUNC(spm::an2_08::evt_rpg_calc_item_stats, LW(2), LW(10), LW(6), LW(7)) //hp gain goes in LW 6, xp in LW 7
            IF_LARGE(LW(6), 0)
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_KINKYU_KINOKO1"))
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_EFFECT_SMALL1"))
                WAIT_MSEC(350)
                USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_I_RECOVER_HP_SMALL1"))
                USER_FUNC(spm::evt_sub::evt_sub_get_language, LW(8))
                SWITCH(LW(8))
                    CASE_EQUAL(3)
                        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_063"), LW(6), LW(5))
                    CASE_ETC()
                        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_063"), LW(5), LW(6))
                END_SWITCH()
                USER_FUNC(spm::evt_pouch::evt_pouch_add_hp, LW(6))
            END_IF()
            SWITCH(LW(2))
                CASE_EQUAL(125)
                    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(8))
                    IF_FLAG(LW(8), 0x8)
                        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_064"), LW(5))
                        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 8)
                    END_IF()
                CASE_ETC()
                    IF_LARGE(LW(6), 0)
                        USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(8))
                        IF_FLAG(LW(8), 0x8)
                            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_064"), LW(5))
                            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 8)
                        END_IF()
                    END_IF()
            END_SWITCH()
            SWITCH(LW(2))
                CASE_EQUAL(125)
                    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(8))
                    IF_FLAG(LW(8), 0x7800)
                        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_PIKKYORON_SHINE1"))
                        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_065"), LW(5))
                        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 30720)
                    END_IF()
            END_SWITCH()
            IF_LARGE(LW(7), 0)
                USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_066"), LW(7))
                USER_FUNC(spm::an2_08::evt_rpg_add_xp, LW(7))
            END_IF()
            SWITCH(LW(2))
                CASE_EQUAL(98)
                    USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_EVT_PC_POISON1"))
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_067"), LW(5))
                    USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 8)
            END_SWITCH()
            SWITCH(LW(2))
                CASE_OR(201)
                CASE_OR(173)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_085_03"), LW(5), LW(5))
                    USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 16384)
                    CASE_END()
            END_SWITCH()
            SWITCH(LW(2))
                CASE_OR(173)
                CASE_OR(189)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_085_02"), LW(5), LW(5))
                    USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 4096)
                    CASE_END()
            END_SWITCH()
            SWITCH(LW(2))
                CASE_OR(173)
                CASE_OR(144)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_085_05"), LW(5))
                    USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 2048)
                    CASE_END()
            END_SWITCH()
            SWITCH(LW(2))
                CASE_OR(173)
                CASE_OR(185)
                    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_085_04"), LW(5), LW(5))
                    USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 1, 8192)
                    CASE_END()
            END_SWITCH()
    END_SWITCH()
    SET(LW(0), 3)
    USER_FUNC(enable_disable_rpg_menu, 0)
    USER_FUNC(spm::evt_msg::evt_msg_continue)
    RETURN()
EVT_END()

EVT_BEGIN(switchChars)
USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_CHANGE_LINE_DRAW1"))
USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_P_CHANGE_LINE_DRAW1"))
USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_CHANGE_LINE_DRAW1"))
USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_P_CHANGE_LINE_DRAW1"))
SWITCH(LW(2))
    CASE_EQUAL(0)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_V_DESIDE_MARIO1"))
    CASE_EQUAL(1)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_V_DESIDE_PEACH1"))
    CASE_EQUAL(2)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_V_DESIDE_KOOPA1"))
    CASE_EQUAL(3)
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_P_V_DESIDE_LUIGI1"))
END_SWITCH()
SWITCH(LW(2))
    CASE_EQUAL(0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_087"), LW(10))
    CASE_EQUAL(2)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_088"), LW(10))
    CASE_EQUAL(3)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_089"), LW(10))
END_SWITCH()
USER_FUNC(spm::evt_mario::evt_mario_set_character, LW(2))
USER_FUNC(spm::evt_msg::evt_msg_continue)
RETURN()
EVT_END()

EVT_BEGIN(escape)
    USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_090"), LW(10))
    USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_EVT_MARIO_RUNAWAY1"), PTR("SFX_EVT_MARIO_RUNAWAY1"), PTR("SFX_EVT_KOOPA_RUNAWAY1"), PTR("SFX_EVT_MARIO_RUNAWAY1"))
    WAIT_MSEC(200)
    USER_FUNC(spm::evt_sub::evt_sub_random, 1000, LW(10))
    ADD(LW(10), 301)
    IF_SMALL(LW(10), 300)
        USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_091"))
        SET(LF(0), 1)
        SET(LW(0), 0)
    ELSE()
        USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_092"))
    END_IF()
    USER_FUNC(enable_disable_rpg_menu, 0)
    USER_FUNC(spm::evt_msg::evt_msg_continue)
    RETURN()
EVT_END()

EVT_BEGIN(playMusic)
  USER_FUNC(getCurMap, LW(0))
  USER_FUNC(compareStrings, LW(0), PTR("he1"), LW(1))
  IF_EQUAL(LW(1), 1)
    USER_FUNC(spm::evt_snd::evt_snd_bgmon_f_d, 0, PTR("BGM_MAP_STG1"), 1000)
  END_IF()
  USER_FUNC(compareStrings, LW(0), PTR("he2"), LW(1))
  IF_EQUAL(LW(1), 1)
    USER_FUNC(spm::evt_snd::evt_snd_bgmon_f_d, 0, PTR("BGM_MAP_STG1_SABAKU1"), 1000)
  END_IF()
  USER_FUNC(compareStrings, LW(0), PTR("he3"), LW(1))
  IF_EQUAL(LW(1), 1)
    USER_FUNC(compareStrings, LW(0), PTR("he3_04"), LW(1))
    IF_EQUAL(LW(1), 0)
      USER_FUNC(spm::evt_snd::evt_snd_bgmon_f_d, 0, PTR("BGM_MAP_STG1_SABAKU1"), 1000)
    END_IF()
  END_IF()
RETURN()
EVT_END()

EVT_BEGIN(rpg_check_win_or_continue_evt)
    USER_FUNC(spm::an2_08::evt_rpg_wakeup_check, 0, LW(0))
    IF_NOT_EQUAL(LW(0), 0)
        USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 0, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, LW(0), LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_wakeup_check, 1, LW(0))
    IF_NOT_EQUAL(LW(0), 0)
        USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 1, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, LW(0), LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_wakeup_check, 2, LW(0))
    IF_NOT_EQUAL(LW(0), 0)
        USER_FUNC(spm::an2_08::evt_rpg_underchomp_name_grab, 2, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, LW(0), LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 0, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_125"), LW(1))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_SLIT_RETURN1"))
        USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_SLIT_RETURN1"))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 1)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 1, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_126"), LW(1))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon_character, PTR("SFX_P_MARIO_JUMP1"), PTR("SFX_P_PEACH_JUMP1"), PTR("SFX_P_KOOPA_JUMP1"), PTR("SFX_P_LUIGI_JUMP1"))
        WAIT_MSEC(500)
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 2)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 2, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_127"), LW(1))
        USER_FUNC(spm::evt_snd::evt_snd_sfxon, PTR("SFX_F_MINI_KAKUDAI1"))
        USER_FUNC(spm::evt_snd::evt_snd_sfx_wait_name, PTR("SFX_F_MINI_KAKUDAI1"))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 4)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 3, LW(0))
    IF_EQUAL(LW(0), 1)
        RUN_CHILD_EVT(mod::marioRPGtakeDamage)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_119"), LW(1), 1)
        USER_FUNC(spm::an2_08::evt_rpg_mario_take_damage, 1, 0, LW(1))
        RUN_CHILD_EVT(mod::rpgDeathHandler) //80df1a00
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    ELSE()
        IF_EQUAL(LW(0), 2)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
            USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_120"), LW(1))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 8)
            USER_FUNC(spm::evt_msg::evt_msg_continue)
        END_IF()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 4, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_124"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 16)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 12, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_124_03"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 4096)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 14, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_124_04"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 16384)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 13, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_124_05"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 8192)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 11, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_117"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 2048)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 5, LW(0))
    IF_EQUAL(LW(0), 1)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_117"), LW(1))
        USER_FUNC(spm::evt_pouch::evt_pouch_add_hp, 1)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    ELSE()
        IF_EQUAL(LW(0), 2)
            USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_118"))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 32)
            USER_FUNC(spm::evt_msg::evt_msg_continue)
        END_IF()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 6, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_123"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 64)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 7, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_122"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 128)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 8, LW(0))
    IF_EQUAL(LW(0), 2)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_121"), LW(1))
        USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 256)
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 9, LW(0))
    IF_EQUAL(LW(0), 1)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_124_01"), LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    ELSE()
        IF_EQUAL(LW(0), 2)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
            USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_124_02"), LW(1))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 512)
            USER_FUNC(spm::evt_msg::evt_msg_continue)
        END_IF()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effects_handle, 10, LW(0))
    IF_EQUAL(LW(0), 1)
        USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
        USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_112"), LW(1))
        USER_FUNC(spm::evt_msg::evt_msg_continue)
    ELSE()
        IF_EQUAL(LW(0), 2)
            USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(1))
            USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_115"), LW(1))
            USER_FUNC(spm::an2_08::evt_rpg_menu_effects_handler, 0, 1024)
            USER_FUNC(spm::evt_msg::evt_msg_continue)
        END_IF()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 0, LW(0))
    IF_NOT_FLAG(LW(0), 0x8000)
        RETURN()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 1, LW(0))
    IF_NOT_FLAG(LW(0), 0x8000)
        RETURN()
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_enemy_death_check, 2, LW(0))
    IF_NOT_FLAG(LW(0), 0x8000)
        RETURN()
    END_IF()
    INLINE_EVT()
        USER_FUNC(spm::evt_snd::evt_snd_bgmoff, 0)
        USER_FUNC(spm::evt_snd::evt_snd_bgmon, 2, PTR("BGM_EVT_STG7_RPG_FF1"))
        WAIT_MSEC(2000)
        //USER_FUNC(spm::evt_snd::evt_snd_bgmon, 2, PTR("BGM_MAP_STG4_4D1"))
        //USER_FUNC(spm::evt_snd::evt_snd_envon_f, 0, PTR("ENV_AN2_08"), 1000)
    END_INLINE()
    USER_FUNC(spm::an2_08::evt_rpg_char_get, LW(10))
    USER_FUNC(spm::an2_08::evt_rpg_point_calculation, 0, LW(11))
    USER_FUNC(spm::an2_08::evt_rpg_point_calculation, 1, LW(12))
    USER_FUNC(spm::an2_08::evt_rpg_point_calculation, 2, LW(13)) //fills the lws with points gained from the turn based combat
    USER_FUNC(spm::an2_08::evt_rpg_point_handling, LW(14))
    ADD(LW(11), LW(12))
    ADD(LW(11), LW(13))
    ADD(LW(11), LW(14)) //and adds them to a total here
    USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
    USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_008"), LW(10), LW(11))
    USER_FUNC(spm::evt_pouch::evt_pouch_add_xp, LW(11))
    USER_FUNC(spm::evt_pouch::evt_pouch_get_xp, LW(0))
    USER_FUNC(spm::evt_pouch::evt_pouch_get_next_level_xp, LW(1))
    IF_LARGE_EQUAL(LW(0), LW(1))
        USER_FUNC(spm::evt_pouch::evt_pouch_get_level, LW(0))
        ADD(LW(0), 1)
        USER_FUNC(spm::evt_pouch::evt_pouch_set_level, LW(0))
        USER_FUNC(spm::evt_pouch::evt_pouch_get_level, LW(0))
        MOD(LW(0), 2)
        IF_EQUAL(LW(0), 0)
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_009"))
            WAIT_MSEC(500)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_009_02"), 5)
            USER_FUNC(spm::evt_pouch::evt_pouch_get_max_hp, LW(0))
            ADD(LW(0), 5)
            USER_FUNC(spm::evt_pouch::evt_pouch_set_max_hp, LW(0))
        ELSE()
            USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_009"))
            WAIT_MSEC(500)
            USER_FUNC(spm::evt_msg::evt_msg_print_add_insert, 0, PTR("stg7_2_133_2_009_01"), 1)
            USER_FUNC(spm::evt_pouch::evt_pouch_get_attack, LW(0))
            ADD(LW(0), 1)
            USER_FUNC(spm::evt_pouch::evt_pouch_set_attack, LW(0))
        END_IF()
        USER_FUNC(spm::evt_pouch::evt_pouch_get_max_hp, LW(0))
        USER_FUNC(spm::evt_pouch::evt_pouch_set_hp, LW(0))
    END_IF()
    SET(LF(0), 1)
    SET(LW(0), 1)
    USER_FUNC(spm::evt_msg::evt_msg_continue)
    RETURN()
EVT_END()

EVT_BEGIN(setup_fight)
  USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(0), LW(1), LW(2))
  SUB(LW(0), 100)
  SET(LW(2), FLOAT(0.0))
  USER_FUNC(spm::evt_mario::evt_mario_set_pos, LW(0), LW(1), LW(2))
  SET(UW(4), LW(0))
  USER_FUNC(spm::evt_cam::evt_cam_get_pos, 5, LW(0), LW(1), LW(2))
  SUB(LW(2), 300)
  USER_FUNC(spm::evt_cam::evt_cam3d_evt_zoom_in, 0, LW(0), EVT_NULLPTR, LW(2), LW(0), EVT_NULLPTR, 300, 0, 11)
  SET(UW(1), LW(0))
  SET(UW(2), LW(1))
  SET(UW(3), LW(2))
  USER_FUNC(spm::evt_mario::evt_mario_get_pos, LW(0), LW(1), LW(2))
  ADD(LW(0), 200)
  USER_FUNC(get_rpg_enemy_info, 0, LW(3), LW(4), LW(5))
  IF_EQUAL(LW(3), -1)
    GOTO(1)
  END_IF()
  USER_FUNC(spm::evt_npc::evt_npc_entry, PTR("npc1"), LW(4), 0)
  USER_FUNC(spm::evt_npc::evt_npc_set_position, PTR("npc1"), LW(0), LW(1), LW(2))
  USER_FUNC(spm::evt_mobj::evt_mobj_blk, 4, PTR("mobj1"), 0, 0, 0, 0, 0, 0)
  USER_FUNC(spm::evt_mobj::evt_mobj_set_position, PTR("mobj1"), LW(0), LW(1), LW(2))
  USER_FUNC(mobjChangeAnimPoseName, PTR("mobj1"), PTR("MOBJ_su_blank"))
  USER_FUNC(spm::evt_mobj::evt_mobj_hit_onoff, 0, PTR("mobj1"))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc1"), 0, LW(0))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc1"), 1, LW(1))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc1"), 2, LW(2))
  USER_FUNC(spm::evt_npc::evt_npc_set_property, PTR("npc1"), 0xe, LW(3))
  USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc1"), 0, 1)
  USER_FUNC(spm::evt_npc::evt_npc_flag8_onoff, PTR("npc1"), 1, 201326596)
  IF_NOT_EQUAL(LW(5), 0)
    SET(UW(0), 0)
    SET(LW(15), PTR("npc1"))
    RUN_CHILD_EVT(LW(5))
  END_IF()
  LBL(1)
  ADD(LW(0), 50)
  USER_FUNC(get_rpg_enemy_info, 1, LW(3), LW(4), LW(5))
  IF_EQUAL(LW(3), -1)
    GOTO(2)
  END_IF()
  USER_FUNC(spm::evt_npc::evt_npc_entry, PTR("npc2"), LW(4), 0)
  USER_FUNC(spm::evt_npc::evt_npc_set_position, PTR("npc2"), LW(0), LW(1), LW(2))
  USER_FUNC(spm::evt_mobj::evt_mobj_blk, 4, PTR("mobj2"), 0, 0, 0, 0, 0, 0)
  USER_FUNC(spm::evt_mobj::evt_mobj_set_position, PTR("mobj2"), LW(0), LW(1), LW(2))
  USER_FUNC(mobjChangeAnimPoseName, PTR("mobj2"), PTR("MOBJ_su_blank"))
  USER_FUNC(spm::evt_mobj::evt_mobj_hit_onoff, 0, PTR("mobj2"))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc2"), 0, LW(0))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc2"), 1, LW(1))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc2"), 2, LW(2))
  USER_FUNC(spm::evt_npc::evt_npc_set_property, PTR("npc2"), 0xe, LW(3))
  USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc2"), 0, 1)
  USER_FUNC(spm::evt_npc::evt_npc_flag8_onoff, PTR("npc2"), 1, 201326596)
  IF_NOT_EQUAL(LW(5), 0)
    SET(UW(0), 1)
    SET(LW(15), PTR("npc2"))
    RUN_CHILD_EVT(LW(5))
  END_IF()
  LBL(2)
  ADD(LW(0), 50)
  USER_FUNC(get_rpg_enemy_info, 2, LW(3), LW(4), LW(5))
  IF_EQUAL(LW(3), -1)
    GOTO(3)
  END_IF()
  USER_FUNC(spm::evt_npc::evt_npc_entry, PTR("npc3"), LW(4), 0)
  USER_FUNC(spm::evt_npc::evt_npc_set_position, PTR("npc3"), LW(0), LW(1), LW(2))
  USER_FUNC(spm::evt_mobj::evt_mobj_blk, 4, PTR("mobj3"), 0, 0, 0, 0, 0, 0)
  USER_FUNC(spm::evt_mobj::evt_mobj_set_position, PTR("mobj3"), LW(0), LW(1), LW(2))
  USER_FUNC(mobjChangeAnimPoseName, PTR("mobj3"), PTR("MOBJ_su_blank"))
  USER_FUNC(spm::evt_mobj::evt_mobj_hit_onoff, 0, PTR("mobj3"))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc3"), 0, LW(0))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc3"), 1, LW(1))
  USER_FUNC(spm::evt_npc::evt_npc_set_unitwork, PTR("npc3"), 2, LW(2))
  USER_FUNC(spm::evt_npc::evt_npc_set_property, PTR("npc3"), 0xe, LW(3))
  USER_FUNC(spm::evt_npc::evt_npc_set_anim, PTR("npc3"), 0, 1)
  USER_FUNC(spm::evt_npc::evt_npc_flag8_onoff, PTR("npc3"), 1, 201326596)
  IF_NOT_EQUAL(LW(5), 0)
    SET(UW(0), 2)
    SET(LW(15), PTR("npc3"))
    RUN_CHILD_EVT(LW(5))
  END_IF()
  LBL(3)
  RETURN()
EVT_END()


EVT_BEGIN(beginRPG) //80df2e90
//USER_FUNC(spm::an::evt_an_init_tpl)
USER_FUNC(spm::evt_snd::evt_snd_string_call, 0)
USER_FUNC(spm::evt_paper::evt_paper_entry, PTR("OFF_house_02"))
USER_FUNC(spm::evt_img::evt_img_entry, PTR("img"))
USER_FUNC(spm::evt_img::evt_img_set_paper, PTR("img"), PTR("OFF_house_02"))
USER_FUNC(spm::evt_img::evt_img_set_paper_anim, PTR("img"), PTR("A_2"))
USER_FUNC(spm::evt_img::evt_img_alloc_capture, PTR("img"), 0, 0, 1, 0, 0, 608, 480)
USER_FUNC(spm::evt_img::evt_img_free_capture, PTR("img"), 1)
USER_FUNC(spm::evt_img::evt_img_wait_animend, PTR("img"))
USER_FUNC(spm::evt_fade::evt_fade_entry, 2, 0, 0, 0, 0, 255)
USER_FUNC(spm::evt_fade::evt_fade_end_wait, -1)
INLINE_EVT()
    USER_FUNC(spm::an2_08::evt_rpg_npctribe_handle)
END_INLINE()
USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
//USER_FUNC(spm::evt_fade::evt_fade_entry, 65554, 0, 0, 0, 0, 255)
USER_FUNC(spm::evt_img::evt_img_free_capture, PTR("img"), 0)
USER_FUNC(spm::evt_img::evt_img_release, PTR("img"))
USER_FUNC(spm::evt_paper::evt_paper_delete, PTR("OFF_house_02"))
USER_FUNC(mod::rpg_npc_setup)
RUN_CHILD_EVT(mod::setup_fight)
USER_FUNC(spm::evt_mario::evt_mario_direction_face, 90, 200)
USER_FUNC(enable_disable_rpg_menu, 1)
WAIT_FRM(10)
USER_FUNC(spm::evt_fade::evt_fade_entry, 1, 300, 0, 0, 0, 255)
USER_FUNC(spm::evt_fade::evt_fade_end_wait, -1)
USER_FUNC(spm::evt_msg::evt_msg_print_add, 0, PTR("stg7_2_133_2_001"))
WAIT_MSEC(2000)
IF_EQUAL(GSWF(1800), 0)
  USER_FUNC(spm::evt_msg::evt_msg_print_add, 1, PTR(tutorial))
  SET(GSWF(1800), 1)
END_IF()
SET(UW(5), 0)
USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("P_1"), 0)
DO(0)
    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
    IF_FLAG(LW(0), 0x1000)
        USER_FUNC(spm::evt_sub::evt_sub_set_game_speed, FLOAT(0.5))
    END_IF()
    USER_FUNC(spm::an2_08::evt_rpg_effect_check, LW(0))
    IF_NOT_FLAG(LW(0), 0x600)
        USER_FUNC(spm::an2_08::evt_rpg_choice_handler, LW(0), LW(1), LW(2), LW(3), LW(4))
        SWITCH(LW(0))
            CASE_EQUAL(0)
                RUN_CHILD_EVT(mod::attack) //handles the attack input
            CASE_EQUAL(1)
                RUN_CHILD_EVT(mod::technique) //handles the technique input, none avaliable for peach in vanilla
            CASE_EQUAL(2)
                RUN_CHILD_EVT(mod::pixls) //handles pixls
            CASE_EQUAL(3)
                RUN_CHILD_EVT(mod::items) //handles items
            CASE_EQUAL(4)
                RUN_CHILD_EVT(mod::switchChars) //handles switching characters
                GOTO(0)
            CASE_EQUAL(5)
                SET(LF(0), 0)
                RUN_CHILD_EVT(mod::escape) //handles run away
                IF_EQUAL(LF(0), 1)
                    DO_BREAK()
                END_IF()
        END_SWITCH()
END_IF()
USER_FUNC(spm::evt_sub::evt_sub_set_game_speed, FLOAT(1.0))
RUN_CHILD_EVT(mod::runEnemyTurn)
SET(LF(0), 0)
RUN_CHILD_EVT(mod::rpg_check_win_or_continue_evt)
IF_EQUAL(LF(0), 1)
   DO_BREAK()
END_IF()
LBL(0)
USER_FUNC(enable_disable_rpg_menu, 1)
USER_FUNC(spm::evt_msg::evt_msg_print, 1, PTR("<dq><once_stop>"), 0, 0)
USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("P_1"), 0)
SET(UW(5), 0)
WHILE()
USER_FUNC(spm::evt_fade::evt_fade_entry, 2, 500, 0, 0, 0, 255)
USER_FUNC(spm::evt_fade::evt_fade_end_wait, -1)
USER_FUNC(spm::evt_npc::evt_npc_stats_set_up, 296, 1)
USER_FUNC(spm::evt_fade::evt_fade_callfade, 1)
USER_FUNC(spm::an2_08::evt_rpg_change_menu_flag)
USER_FUNC(spm::evt_cam::evt_cam_zoom_to_coords, 0, 11)
USER_FUNC(spm::evt_mario::evt_mario_set_pose, PTR("S_1"), 0)
USER_FUNC(mod::rpg_off)
USER_FUNC(spm::evt_sub::evt_sub_set_game_speed, FLOAT(1.0))
USER_FUNC(spm::evt_fade::evt_fade_entry, 1, 500, 0, 0, 0, 255)
USER_FUNC(spm::evt_fade::evt_fade_end_wait, -1)
USER_FUNC(spm::evt_snd::evt_snd_bgmoff, 0)
USER_FUNC(rpg_set_dialogue, PTR(stg7_2_133_2_002))
RUN_CHILD_EVT(playMusic)
IF_EQUAL(LW(0), 0)
//USER_FUNC(spm::evt_snd::evt_snd_envon_f, 0, PTR("ENV_AN2_08"), 1000)
SET(LW(0), 0)
RETURN()
END_IF()
IF_EQUAL(LW(0), 1)
SET(LW(0), 1)
RETURN()
END_IF()
EVT_END()



EVT_BEGIN(parentOfBeginRPG)
  USER_FUNC(spm::evt_mario::evt_mario_key_off, 0)
  IF_EQUAL(LW(0), 1)
  USER_FUNC(spm::evt_snd::evt_snd_bgmon, 0, PTR("BGM_BTL_BOSS_MIDDLE1")) //original is BGM_EVT_STG7_RPG1
  END_IF()
  ALLOC_USER_WRK(7)
  INLINE_EVT()
    USER_FUNC(spm::evt_env::evt_env_blur_on, 0, 500)
  END_INLINE()
  USER_FUNC(spm::evt_pouch::evt_pouch_add_item, 220)
  RUN_CHILD_EVT(mod::beginRPG)
  IF_EQUAL(LW(0), 0) //only happens if you run away successfully
    WAIT_MSEC(500)
  ELSE()//only happens if you win the RPG battle
  USER_FUNC(spm::evt_pouch::evt_pouch_increment_enemies_defeated)
  WAIT_MSEC(500)
  // I'll throw other enemy logic here later
  END_IF()
  USER_FUNC(spm::evt_pouch::evt_pouch_remove_item, 220)
  USER_FUNC(spm::evt_mario::evt_mario_key_on)
  RETURN()
EVT_END()

EVT_BEGIN(deleteAttackedEnemy)
  WAIT_MSEC(700)
  USER_FUNC(spm::evt_npc::evt_npc_delete, LW(0))
  RETURN()
EVT_END()

}
